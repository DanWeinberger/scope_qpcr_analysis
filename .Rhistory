summarize(freq_activity=mean(soc_activity, na.rm=T), N_activity=sum(soc_activity, na.rm=T),
freq_family=mean(soc_activity_family, na.rm=T),N_activity_family=sum(soc_activity_family, na.rm=T),
freq_friend=mean(soc_activity_friend, na.rm=T),N_activity_friends=sum(soc_activity_friend, na.rm=T),
freq_comm_ctr=mean(soc_activity_comm_ctr, na.rm=T),N_activity_comm_ctr=sum(soc_activity_comm_ctr, na.rm=T),
freq_fitness=mean(soc_activity_fitness, na.rm=T),N_activity_fitness=sum(soc_activity_fitness, na.rm=T)
)
demographics <- read_excel('./Data/scope_demographics deidentified S1.xlsx') %>%
mutate(ID =as.numeric(ID)) %>%
rename(Age2=Age, Gender2=Gender, Race2=Race, Ethnicity2=Ethnicity)
#season1 baseline variables
baseline_s1 <- key2 %>%
rename(MRN=`MR#`) %>%
mutate(MRN=if_else(MRN==" 6450061","6450061", MRN),
MRN_cleaned = as.character(gsub('MR','',MRN))) %>%
full_join(y=q0, by=c("MRN_cleaned"="MRN") ) %>%
dplyr::select(MRN_cleaned,`ID Number`,pneu_vax, pneu_vax_date,ethnicity,weight,height,education, immuno_meds ,current_smoke,diabetes_meds, asthma_meds,flu_shot) %>%
rename(ID=`ID Number`) %>%
full_join(demographics, by='ID') %>%
mutate(Race2=if_else(is.na(Race2), ethnicity, Race2)) %>%
dplyr::select(-ethnicity)
#baseline_s1 <- q0[, c('MRN',q0.baseline.vars)]
saveRDS(baseline_s1,'./Data/confidential/s1_baseline_vars.rds')
out.list <- list('actitivity_summary_s1'=actitivity_summary, 'survey_and_pcr_s1'=e3, 's1_baseline_vars'=baseline_s1)
return(out.list)
}
s1_data <- clean_s1_surveys()
saveRDS(s1_data,'./Data/confidential/s1_survey_clean.rds')
unique(s1_data$survey_and_pcr_s1$pneu_vax)
unique(s1_data$survey_and_pcr_s1$pneu_vax_dic)
s1 <- s1_data$survey_and_pcr_s1 %>%
rename(flu_shot1=flu_shot) %>%
mutate(flu_shot = if_else(flu_shot1=='Yes',1,
if_else(flu_shot1=='No',2, NA_real_))) %>%
select(ID, time, Household, lyta, piab,activities, activity_family, activity_friends, activity_community_center, acitivity_fitness,child_contact,child_contact_u12m,child_contact_13_23m,child_contact_24_59m ,child_contact_5_10y,child_contact_over10y , Age, Gender, Race, Ethnicity,child_contact_often,child_contact_hours,recent_abx,recent_runny_nose, recent_nasal,
smoke_dic, pneu_vax_dic, flu_shot,education)
s2 <- s2_data$survey_and_pcr_s2  %>%
mutate(recent_runny_nose = if_else(running_nose==1,'Yes', if_else(running_nose==2,'No','999') ),
recent_nasal = if_else(nasal_congestion==1,'Yes', if_else(nasal_congestion==2,'No','999') ),
recent_abx = if_else(antibiotics_2weeks==1,'Yes', if_else(antibiotics_2weeks==0,'No','999') )
)%>%
select(ID, time, Household,s1_match, lyta, piab,activities, activity_family, activity_friends, activity_community_center, acitivity_fitness,child_contact, child_contact_u12m,child_contact_13_23m,child_contact_24_59m ,child_contact_5_10y,child_contact_over10y, Age, Gender, Race, Ethnicity,
child_contact_often,child_contact_hours,recent_runny_nose,recent_nasal, recent_abx,recent_pneumo_vax, recent_flu_vax, recent_covid_vax,
smoke,pneu_vax, flu_shot,education)
ds.c <- bind_rows(s1, s2) %>%
mutate(season= str_extract(ID, "[^_]+"),
piab_pos=1*(piab<45) ,
Age=round(Age),
agec = if_else(Age>=60 & Age <70 ,1,
if_else(Age>=70 & Age<100 ,2,NA_real_ ))) %>%
filter(!is.na(ID))
unique(ds.c$pneu_vax)
s1 <- s1_data$survey_and_pcr_s1 %>%
rename(flu_shot1=flu_shot) %>%
mutate(flu_shot = if_else(flu_shot1=='Yes',1,
if_else(flu_shot1=='No',2, NA_real_))) %>%
select(ID, time, Household, lyta, piab,activities, activity_family, activity_friends, activity_community_center, acitivity_fitness,child_contact,child_contact_u12m,child_contact_13_23m,child_contact_24_59m ,child_contact_5_10y,child_contact_over10y , Age, Gender, Race, Ethnicity,child_contact_often,child_contact_hours,recent_abx,recent_runny_nose, recent_nasal,
smoke_dic, pneu_vax_dic, flu_shot,education)  %>%
rename(pneu_vax=pneu_vax_dic, smoke=smoke_dic)
s2 <- s2_data$survey_and_pcr_s2  %>%
mutate(recent_runny_nose = if_else(running_nose==1,'Yes', if_else(running_nose==2,'No','999') ),
recent_nasal = if_else(nasal_congestion==1,'Yes', if_else(nasal_congestion==2,'No','999') ),
recent_abx = if_else(antibiotics_2weeks==1,'Yes', if_else(antibiotics_2weeks==0,'No','999') )
)%>%
select(ID, time, Household,s1_match, lyta, piab,activities, activity_family, activity_friends, activity_community_center, acitivity_fitness,child_contact, child_contact_u12m,child_contact_13_23m,child_contact_24_59m ,child_contact_5_10y,child_contact_over10y, Age, Gender, Race, Ethnicity,
child_contact_often,child_contact_hours,recent_runny_nose,recent_nasal, recent_abx,recent_pneumo_vax, recent_flu_vax, recent_covid_vax,
smoke,pneu_vax, flu_shot,education)
ds.c <- bind_rows(s1, s2) %>%
mutate(season= str_extract(ID, "[^_]+"),
piab_pos=1*(piab<45) ,
Age=round(Age),
agec = if_else(Age>=60 & Age <70 ,1,
if_else(Age>=70 & Age<100 ,2,NA_real_ ))) %>%
filter(!is.na(ID))
unique(ds.c$smoke)
ds.c <- bind_rows(s1, s2) %>%
mutate(season= str_extract(ID, "[^_]+"),
piab_pos=1*(piab<45) ,
Age=round(Age),
agec = if_else(Age>=60 & Age <70 ,1,
if_else(Age>=70 & Age<100 ,2,NA_real_ )),
smoke=if_else(smoke==2,0, smoke)) %>%
filter(!is.na(ID))
unique(ds.c$smoke)
unique(ds.c$pneu_vax)
unique(ds.c$flu_shot)
ds.c <- bind_rows(s1, s2) %>%
mutate(season= str_extract(ID, "[^_]+"),
piab_pos=1*(piab<45) ,
Age=round(Age),
agec = if_else(Age>=60 & Age <70 ,1,
if_else(Age>=70 & Age<100 ,2,NA_real_ )),
smoke=if_else(smoke==2,0, smoke),
flu_shot=if_else(flu_shot==2,0, flu_shot)) %>%
filter(!is.na(ID))
write.csv(ds.c,'./Data/pcr_survey_combined.csv')
saveRDS(ds.c,'./Data/pcr_survey_combined.rds')
ds.c %>%
group_by(season) %>%
summarize(prevalence= mean(piab_pos, na.rm=T), N_pos=sum(piab_pos, na.rm=T), n_test=n())
ds.c$Gender[ds.c$Gender=='Female'] <- 'F'
ds.c$Gender[ds.c$Gender=='Male'] <- 'M'
table(ds.c$piab_pos, ds.c$Gender)
ds.c %>%
filter(piab_pos==1) %>%
group_by(Gender) %>%
summarize(mean_ct=mean(piab))
piab_men <- ds.c %>%
filter(piab_pos==1 & Gender=='M')
piab_women <- ds.c %>%
filter(piab_pos==1 & Gender=='F')
wilcox.test(piab_women$piab, piab_men$piab, alternative = "two.sided")
ds.c %>%
filter(piab_pos==1) %>%
ggplot( aes(x=Gender,y=piab)) +
geom_violin()+ theme_classic()
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
options(dplyr.summarise.inform = FALSE)
library(ggplot2)
library(ggalluvial)
library(kableExtra)
library(knitr)
library(readxl)
library(gee)
library(reshape2)
library(flextable)
library(msm)
library(patchwork)
library(gridExtra)
library(pheatmap)
library(RColorBrewer)
library(table1)
source('heat.fun.R')
source('heat.fun.contact.R')
source('./R/clean_pcr.R')
source('./R/clean_s1_surveys.R')
source('./R/clean_s2_surveys.R')
clean_pcr <- clean_pcr_fun()
pcr_summary_long <- readRDS('./Data/PCR_compiled.rds')
pcr_survey <- readRDS('./Data./pcr_survey_combined.rds') %>%
mutate(Gender = if_else(Gender %in% c('F','Female'),'F',Gender),
Gender = if_else(Gender %in% c('M','Male'),'M',Gender),
child_contact_often= if_else(is.na(child_contact_often),999,child_contact_often)) %>%
filter(piab != 9999) %>%
mutate(piab_pos = if_else(piab < 40,1,0),
lyta_pos = if_else(lyta < 40,1,0),
season=substr(ID,1,2),
Gender=if_else(ID=='S2_77' & is.na(Gender), 'F',Gender))
unique.age <- pcr_survey %>%
group_by(ID) %>%
summarize(Age=mean(Age, na.rm=T))
hist(unique.age$Age, main='Distribution of ages', xlab='Age(y)')
unique.age %>%
summarize(mean=mean(Age, na.rm=T), min=min(Age, na.rm=T), max=max(Age, na.rm=T))
first_visit <- pcr_survey %>% filter(time==1) %>%
mutate(Race=tolower(Race), Ethnicity=tolower(Ethnicity))
tab1 <- table1( ~Age + Gender + Race +Ethnicity + activity_family + activity_friends + smoke+ activity_community_center , data=first_visit)
tab1 <- as.data.frame(tab1)
flextable(tab1)
first_visit <- pcr_survey %>% filter(time==1) %>%
mutate(Race=tolower(Race), Ethnicity=tolower(Ethnicity), smoke=as.factor(smoke))
tab1 <- table1( ~Age + Gender + Race +Ethnicity + activity_family + activity_friends + smoke+ activity_community_center , data=first_visit)
tab1 <- as.data.frame(tab1)
flextable(tab1)
names(pcr_survey)
first_visit <- pcr_survey %>% filter(time==1) %>%
mutate(Race=tolower(Race), Ethnicity=tolower(Ethnicity), smoke=as.factor(smoke), pneu_vax=as.factor(pneu_vax), flu_shot=as.factor(flu_shot) )
tab1 <- table1( ~Age + Gender + Race +Ethnicity + activity_family + activity_friends + smoke+ pneu_vax + flu_shot + activity_community_center , data=first_visit)
tab1 <- as.data.frame(tab1)
flextable(tab1)
names(s1_data$survey_and_pcr_s1 )
unique(s1_data$survey_and_pcr_s1$asthma_meds)
table(s1_data$survey_and_pcr_s1$asthma_meds)
table(s1_data$survey_and_pcr_s1$diabetes)
s1 <- s1_data$survey_and_pcr_s1 %>%
rename(flu_shot1=flu_shot) %>%
mutate(flu_shot = if_else(flu_shot1=='Yes',1,
if_else(flu_shot1=='No',2, NA_real_)),
diabetes = if_else(diabetes_meds=='Yes',1,
if_else(diabetes_meds=='No',2, NA_real_)),
asthma = if_else(asthma_meds=='Yes',1,
if_else(asthma_meds=='No',2, NA_real_))
) %>%
select(ID, time, Household, lyta, piab,activities, activity_family, activity_friends, activity_community_center, acitivity_fitness,child_contact,child_contact_u12m,child_contact_13_23m,child_contact_24_59m ,child_contact_5_10y,child_contact_over10y , Age, Gender, Race, Ethnicity,child_contact_often,child_contact_hours,recent_abx,recent_runny_nose, recent_nasal,
smoke_dic, pneu_vax_dic, flu_shot,education,diabetes, asthma)  %>%
rename(pneu_vax=pneu_vax_dic, smoke=smoke_dic)
s2 <- s2_data$survey_and_pcr_s2  %>%
mutate(recent_runny_nose = if_else(running_nose==1,'Yes', if_else(running_nose==2,'No','999') ),
recent_nasal = if_else(nasal_congestion==1,'Yes', if_else(nasal_congestion==2,'No','999') ),
recent_abx = if_else(antibiotics_2weeks==1,'Yes', if_else(antibiotics_2weeks==0,'No','999') )
)%>%
select(ID, time, Household,s1_match, lyta, piab,activities, activity_family, activity_friends, activity_community_center, acitivity_fitness,child_contact, child_contact_u12m,child_contact_13_23m,child_contact_24_59m ,child_contact_5_10y,child_contact_over10y, Age, Gender, Race, Ethnicity,
child_contact_often,child_contact_hours,recent_runny_nose,recent_nasal, recent_abx,recent_pneumo_vax, recent_flu_vax, recent_covid_vax,
smoke,pneu_vax, flu_shot,education,diabetes, asthma)
ds.c <- bind_rows(s1, s2) %>%
mutate(season= str_extract(ID, "[^_]+"),
piab_pos=1*(piab<45) ,
Age=round(Age),
agec = if_else(Age>=60 & Age <70 ,1,
if_else(Age>=70 & Age<100 ,2,NA_real_ )),
smoke=if_else(smoke==2,0, smoke),
flu_shot=if_else(flu_shot==2,0, flu_shot)) %>%
filter(!is.na(ID))
table(ds.c$diabetes)
ds.c <- bind_rows(s1, s2) %>%
mutate(season= str_extract(ID, "[^_]+"),
piab_pos=1*(piab<45) ,
Age=round(Age),
agec = if_else(Age>=60 & Age <70 ,1,
if_else(Age>=70 & Age<100 ,2,NA_real_ )),
smoke=if_else(smoke==2,0, smoke),
flu_shot=if_else(flu_shot==2,0, flu_shot),
diabetes=if_else(diabetes==2,0, diabetes)
asthma=if_else(flu_shot==2,0, asthma)) %>%
ds.c <- bind_rows(s1, s2) %>%
mutate(season= str_extract(ID, "[^_]+"),
piab_pos=1*(piab<45) ,
Age=round(Age),
agec = if_else(Age>=60 & Age <70 ,1,
if_else(Age>=70 & Age<100 ,2,NA_real_ )),
smoke=if_else(smoke==2,0, smoke),
flu_shot=if_else(flu_shot==2,0, flu_shot),
diabetes=if_else(diabetes==2,0, diabetes),
asthma=if_else(flu_shot==2,0, asthma)) %>%
filter(!is.na(ID))
write.csv(ds.c,'./Data/pcr_survey_combined.csv')
saveRDS(ds.c,'./Data/pcr_survey_combined.rds')
pcr_summary_long <- readRDS('./Data/PCR_compiled.rds')
pcr_survey <- readRDS('./Data./pcr_survey_combined.rds') %>%
mutate(Gender = if_else(Gender %in% c('F','Female'),'F',Gender),
Gender = if_else(Gender %in% c('M','Male'),'M',Gender),
child_contact_often= if_else(is.na(child_contact_often),999,child_contact_often)) %>%
filter(piab != 9999) %>%
mutate(piab_pos = if_else(piab < 40,1,0),
lyta_pos = if_else(lyta < 40,1,0),
season=substr(ID,1,2),
Gender=if_else(ID=='S2_77' & is.na(Gender), 'F',Gender))
tab1 <- table1( ~Age + Gender + Race +Ethnicity + activity_family + activity_friends + activity_community_center +  smoke+ diabetes + asthma + pneu_vax + flu_shot  , data=first_visit)
first_visit <- pcr_survey %>% filter(time==1) %>%
mutate(Race=tolower(Race), Ethnicity=tolower(Ethnicity), smoke=as.factor(smoke), pneu_vax=as.factor(pneu_vax), flu_shot=as.factor(flu_shot) , diabetes=as.factor(diabetes), asthma=as.factor(asthma))
tab1 <- table1( ~Age + Gender + Race +Ethnicity + activity_family + activity_friends + activity_community_center +  smoke+ diabetes + asthma + pneu_vax + flu_shot  , data=first_visit)
tab1 <- as.data.frame(tab1)
flextable(tab1)
ds.c <- bind_rows(s1, s2) %>%
mutate(season= str_extract(ID, "[^_]+"),
piab_pos=1*(piab<45) ,
Age=round(Age),
agec = if_else(Age>=60 & Age <70 ,1,
if_else(Age>=70 & Age<100 ,2,NA_real_ )),
smoke=if_else(smoke==2,0, smoke),
flu_shot=if_else(flu_shot==2,0, flu_shot),
diabetes=if_else(diabetes==2,0, diabetes),
asthma=if_else(asthma==2,0, asthma)) %>%
filter(!is.na(ID))
write.csv(ds.c,'./Data/pcr_survey_combined.csv')
saveRDS(ds.c,'./Data/pcr_survey_combined.rds')
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
options(dplyr.summarise.inform = FALSE)
library(ggplot2)
library(ggalluvial)
library(kableExtra)
library(knitr)
library(readxl)
library(gee)
library(reshape2)
library(flextable)
library(msm)
library(patchwork)
library(gridExtra)
library(pheatmap)
library(RColorBrewer)
library(table1)
source('heat.fun.R')
source('heat.fun.contact.R')
source('./R/clean_pcr.R')
source('./R/clean_s1_surveys.R')
source('./R/clean_s2_surveys.R')
clean_pcr <- clean_pcr_fun()
pcr_summary_long <- readRDS('./Data/PCR_compiled.rds')
pcr_survey <- readRDS('./Data./pcr_survey_combined.rds') %>%
mutate(Gender = if_else(Gender %in% c('F','Female'),'F',Gender),
Gender = if_else(Gender %in% c('M','Male'),'M',Gender),
child_contact_often= if_else(is.na(child_contact_often),999,child_contact_often)) %>%
filter(piab != 9999) %>%
mutate(piab_pos = if_else(piab < 40,1,0),
lyta_pos = if_else(lyta < 40,1,0),
season=substr(ID,1,2),
Gender=if_else(ID=='S2_77' & is.na(Gender), 'F',Gender))
unique.age <- pcr_survey %>%
group_by(ID) %>%
summarize(Age=mean(Age, na.rm=T))
hist(unique.age$Age, main='Distribution of ages', xlab='Age(y)')
unique.age %>%
summarize(mean=mean(Age, na.rm=T), min=min(Age, na.rm=T), max=max(Age, na.rm=T))
first_visit <- pcr_survey %>% filter(time==1) %>%
mutate(Race=tolower(Race), Ethnicity=tolower(Ethnicity), smoke=as.factor(smoke), pneu_vax=as.factor(pneu_vax), flu_shot=as.factor(flu_shot) , diabetes=as.factor(diabetes), asthma=as.factor(asthma),
education=toupper(education) )
unique(first_visit$education)
education_level= if_else(grepl('HIGH', education) |
grepl("GED",education) , 'HS',
if_else(grepl('BACHELOR', education) |
grepl('COLLEGE', education)|
grepl('ASSOCIATE', education)|
grepl('BA', education) ,'Undergrad',
if_else(grepl('MASTER', education)|
grepl('GRADUATE', education)|
grepl('MBA', education)|
grepl('PHD', education)|
grepl('JD', education)|
grepl('J.D.', education)|
grepl('MPH', education)|
grepl('MD', education)|
grepl('DOCTORATE', education)), 'Graduate', 'NA'))
first_visit <- pcr_survey %>% filter(time==1) %>%
mutate(Race=tolower(Race), Ethnicity=tolower(Ethnicity), smoke=as.factor(smoke), pneu_vax=as.factor(pneu_vax), flu_shot=as.factor(flu_shot) , diabetes=as.factor(diabetes), asthma=as.factor(asthma),
education=toupper(education),
education_level= if_else(grepl('HIGH', education) |
grepl("GED",education) , 'HS',
if_else(grepl('BACHELOR', education) |
grepl('COLLEGE', education)|
grepl('ASSOCIATE', education)|
grepl('BA', education) ,'Undergrad',
if_else(grepl('MASTER', education)|
grepl('GRADUATE', education)|
grepl('MBA', education)|
grepl('PHD', education)|
grepl('JD', education)|
grepl('J.D.', education)|
grepl('MPH', education)|
grepl('MD', education)|
grepl('DOCTORATE', education)), 'Graduate', 'NA'))
)
first_visit <- pcr_survey %>% filter(time==1) %>%
mutate(Race=tolower(Race), Ethnicity=tolower(Ethnicity), smoke=as.factor(smoke), pneu_vax=as.factor(pneu_vax), flu_shot=as.factor(flu_shot) , diabetes=as.factor(diabetes), asthma=as.factor(asthma),
education=toupper(education),
education_level= if_else(grepl('HIGH', education) |
grepl("GED",education) , 'HS',
if_else(grepl('BACHELOR', education) |
grepl('COLLEGE', education)|
grepl('ASSOCIATE', education)|
grepl('BA', education) ,'Undergrad',
if_else(grepl('MASTER', education)|
grepl('GRADUATE', education)|
grepl('MBA', education)|
grepl('PHD', education)|
grepl('JD', education)|
grepl('J.D.', education)|
grepl('MPH', education)|
grepl('MD', education)|
grepl('DOCTORATE', education)), 'Graduate', 'NA_character'))
)
first_visit <- pcr_survey %>% filter(time==1) %>%
mutate(Race=tolower(Race), Ethnicity=tolower(Ethnicity), smoke=as.factor(smoke), pneu_vax=as.factor(pneu_vax), flu_shot=as.factor(flu_shot) , diabetes=as.factor(diabetes), asthma=as.factor(asthma),
education=toupper(education),
education_level= if_else(grepl('HIGH', education) |
grepl("GED",education) , 'HS',
if_else(grepl('BACHELOR', education) |
grepl('COLLEGE', education)|
grepl('ASSOCIATE', education)|
grepl('BA', education) ,'Undergrad',
if_else(grepl('MASTER', education)|
grepl('GRADUATE', education)|
grepl('MBA', education)|
grepl('PHD', education)|
grepl('JD', education)|
grepl('J.D.', education)|
grepl('MPH', education)|
grepl('MD', education)|
grepl('DOCTORATE', education)), 'Graduate', 'Unknown'))
)
first_visit <- pcr_survey %>% filter(time==1) %>%
mutate(Race=tolower(Race), Ethnicity=tolower(Ethnicity), smoke=as.factor(smoke), pneu_vax=as.factor(pneu_vax), flu_shot=as.factor(flu_shot) , diabetes=as.factor(diabetes), asthma=as.factor(asthma),
education=toupper(education),
education_level= if_else(grepl('HIGH', education) |
grepl("GED",education) , 'HS',
if_else(grepl('BACHELOR', education) |
grepl('COLLEGE', education)|
grepl('ASSOCIATE', education)|
grepl('BA', education) ,'Undergrad',
if_else(grepl('MASTER', education)|
grepl('GRADUATE', education)|
grepl('MBA', education)|
grepl('PHD', education)|
grepl('JD', education)|
grepl('J.D.', education)|
grepl('MPH', education)|
grepl('MD', education)|
grepl('DOCTORATE', education), 'Graduate', 'Unknown')))
)
tab1 <- table1( ~Age + Gender + Race +Ethnicity + activity_family + activity_friends + activity_community_center +  smoke+ diabetes + asthma + pneu_vax + flu_shot +education_level , data=first_visit)
tab1 <- as.data.frame(tab1)
flextable(tab1)
names(-   Percent positive by symptoms
```{r}
t5 <- pcr_survey %>%
group_by(recent_nasal) %>%
summarize(N_piaB= sum(piab_pos), N_test= n(), Pct_piab=round(mean(piab_pos)*100,1) ) %>%
mutate( recent_nasal = if_else(is.na(recent_nasal), 'Missing',recent_nasal) )
t5 <- as_grouped_data(x = t5, groups = c("recent_nasal"), columns = NULL)
flextable(t5) )
names(pcr_survey)
names(pcr_survey$pneu_vax)
t5 <- pcr_survey %>%
group_by(recent_nasal) %>%
summarize(N_piaB= sum(piab_pos), N_test= n(), Pct_piab=round(mean(piab_pos)*100,1) )
t5 <- as_grouped_data(x = t5, groups = c("pneu_vax"), columns = NULL)
t5 <- pcr_survey %>%
group_by(pneu_vax) %>%
summarize(N_piaB= sum(piab_pos), N_test= n(), Pct_piab=round(mean(piab_pos)*100,1) )
t5 <- as_grouped_data(x = t5, groups = c("pneu_vax"), columns = NULL)
flextable(t5)
t5 <- pcr_survey %>%
group_by(pneu_vax) %>%
summarize(N_piaB= sum(piab_pos), N_test= n(), Pct_piab=round(mean(piab_pos)*100,1) ) %>%
mutate(pneu_vax = if_else(is.na(pneu_vax),999, pneu_vax))
t5 <- as_grouped_data(x = t5, groups = c("pneu_vax"), columns = NULL)
flextable(t5)
names(pcr_survey)
t5 <- pcr_survey %>%
group_by(diabetes) %>%
summarize(N_piaB= sum(piab_pos), N_test= n(), Pct_piab=round(mean(piab_pos)*100,1) ) %>%
mutate(diabetes = if_else(is.na(diabetes),999, diabetes))
t5 <- as_grouped_data(x = t5, groups = c("diabetes"), columns = NULL)
flextable(t5)
names(pcr_survey)
t5 <- pcr_survey %>%
group_by(asthma) %>%
summarize(N_piaB= sum(piab_pos), N_test= n(), Pct_piab=round(mean(piab_pos)*100,1) ) %>%
mutate(asthma = if_else(is.na(asthma),999, asthma))
t5 <- as_grouped_data(x = t5, groups = c("asthma"), columns = NULL)
flextable(t5)
names(pcr_survey)
t5 <- pcr_survey %>%
mutate(education=toupper(education),
education_level= if_else(grepl('HIGH', education) |
grepl("GED",education) , 'HS',
if_else(grepl('BACHELOR', education) |
grepl('COLLEGE', education)|
grepl('ASSOCIATE', education)|
grepl('BA', education) ,'Undergrad',
if_else(grepl('MASTER', education)|
grepl('GRADUATE', education)|
grepl('MBA', education)|
grepl('PHD', education)|
grepl('JD', education)|
grepl('J.D.', education)|
grepl('MPH', education)|
grepl('MD', education)|
grepl('DOCTORATE', education), 'Graduate', 'Unknown')))) %>%
group_by(education_level) %>%
summarize(N_piaB= sum(piab_pos), N_test= n(), Pct_piab=round(mean(piab_pos)*100,1) ) %>%
mutate(education_level = if_else(is.na(education_level),999, asthma))
t5 <- pcr_survey %>%
mutate(education=toupper(education),
education_level= if_else(grepl('HIGH', education) |
grepl("GED",education) , 'HS',
if_else(grepl('BACHELOR', education) |
grepl('COLLEGE', education)|
grepl('ASSOCIATE', education)|
grepl('BA', education) ,'Undergrad',
if_else(grepl('MASTER', education)|
grepl('GRADUATE', education)|
grepl('MBA', education)|
grepl('PHD', education)|
grepl('JD', education)|
grepl('J.D.', education)|
grepl('MPH', education)|
grepl('MD', education)|
grepl('DOCTORATE', education), 'Graduate', 'Unknown'))))
t5 <- pcr_survey %>%
mutate(education=toupper(education),
education_level= if_else(grepl('HIGH', education) |
grepl("GED",education) , 'HS',
if_else(grepl('BACHELOR', education) |
grepl('COLLEGE', education)|
grepl('ASSOCIATE', education)|
grepl('BA', education) ,'Undergrad',
if_else(grepl('MASTER', education)|
grepl('GRADUATE', education)|
grepl('MBA', education)|
grepl('PHD', education)|
grepl('JD', education)|
grepl('J.D.', education)|
grepl('MPH', education)|
grepl('MD', education)|
grepl('DOCTORATE', education), 'Graduate', 'Unknown')))) %>%
group_by(education_level) %>%
summarize(N_piaB= sum(piab_pos), N_test= n(), Pct_piab=round(mean(piab_pos)*100,1) ) %>%
mutate(education_level = if_else(is.na(education_level),999, education_level))
t5 <- pcr_survey %>%
mutate(education=toupper(education),
education_level= if_else(grepl('HIGH', education) |
grepl("GED",education) , 'HS',
if_else(grepl('BACHELOR', education) |
grepl('COLLEGE', education)|
grepl('ASSOCIATE', education)|
grepl('BA', education) ,'Undergrad',
if_else(grepl('MASTER', education)|
grepl('GRADUATE', education)|
grepl('MBA', education)|
grepl('PHD', education)|
grepl('JD', education)|
grepl('J.D.', education)|
grepl('MPH', education)|
grepl('MD', education)|
grepl('DOCTORATE', education), 'Graduate', 'Unknown')))) %>%
group_by(education_level) %>%
summarize(N_piaB= sum(piab_pos), N_test= n(), Pct_piab=round(mean(piab_pos)*100,1) ) %>%
mutate(education_level = if_else(is.na(education_level),'Unknown', education_level))
t5 <- as_grouped_data(x = t5, groups = c("education_level"), columns = NULL)
flextable(t5)
